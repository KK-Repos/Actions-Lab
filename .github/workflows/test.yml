name: test-NotifyJobStatus

on: workflow_dispatch

env:
  RUN_ID:  ${{ github.run_id }}
  ORG: KK-Repos
  REPO: Actions-Lab
  GH_TOKEN: ${{ secrets.GH_TOKEN }}
  GITHUB_TOKEN : ${{ secrets.GITHUB_TOKEN }}
  JOB_NAME_1: unit-test-job
  JOB_NAME_2: run-cypress-test
  CHANNEL_ID: ${{ secrets.CHANNEL_ID }}
  SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
  CUSTOM_LINK: true
  NEW_LINK_JOB_NAME: ${{ vars.NEW_LINK_JOB_NAME }}
  OLD_LINK_JOB_NAME: ${{ vars.OLD_LINK_JOB_NAME }}
  
jobs:


  unit-test:
    runs-on: ubuntu-latest
    name: unit-test-job
    steps:
      - name: print GITHUB_TOKEN
        run: echo $GITHUB_TOKEN
      - name: run unit test
        run: exit 1

  run-cypress-test-1:
    name: Print "Hi" from run-cypress-test (1)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (1)"

  run-cypress-test-2:
    name: Print "Hi" from run-cypress-test (2)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (2)"

  run-cypress-test-3:
    name: Print "Hi" from run-cypress-test (3)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (3)"

  run-cypress-test-4:
    name: Print "Hi" from run-cypress-test (4)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (4)"

  run-cypress-test-5:
    name: Print "Hi" from run-cypress-test (5)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (5)"

  run-cypress-test-6:
    name: Print "Hi" from run-cypress-test (6)
    runs-on: ubuntu-latest
    steps:
      - name: Print the message
        run: echo "Hi from run-cypress-test (6)"
    
  test-job:
    needs: [run-cypress-test-6]
    if: always()
    runs-on: ubuntu-latest
    name: print Run ID
    steps:
      - name: Print the current run id
        run: echo "PR_NUMBER" $RUN_ID
      - name: custom actions
        id: custom-action
        uses: KK-Repos/NotifyJobStatus@v1
        with:
          ORG: $ORG
          REPO: $ORG
          RUN_ID: ${{ github.run_id }}
          CHANNEL_ID: $CHANNEL_ID
          SLACK_BOT_TOKEN: $SLACK_BOT_TOKEN
      - name: Use Custom Action Output
        run: echo ${{ steps.custom-action.outputs.my_output }}
