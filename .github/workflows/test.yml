name: test-NotifyJobStatus

on: workflow_dispatch

env:
  RUN_ID:  ${{ github.run_id }}
  ORG: ${{ secrets.ORG }}
  REPO: ${{ secrets.REPO }}
  GH_TOKEN: ${{ secrets.GH_TOKEN }}
  JOB_NAME_1: unit-test-job
  JOB_NAME_2: cypress-test-job
  CHANNEL_ID: ${{ secrets.CHANNEL_ID }}
  SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
  CUSTOM_LINK: true
  NEW_LINK_JOB_NAME: ${{ vars.NEW_LINK_JOB_NAME }}
  OLD_LINK_JOB_NAME: ${{ vars.OLD_LINK_JOB_NAME }}
  
jobs:


  unit-test:
    runs-on: ubuntu-latest
    name: unit-test-job
    steps:
      - name: run unit test
        run: exit 1
        
  cypress-test:
    needs: unit-test
    if: always()
    runs-on: ubuntu-latest
    name: cypress-test-job
    steps:
      - name: run unit test
        run: exit 0
    
  test-job:
    needs: [unit-test,cypress-test]
    if: always()
    runs-on: ubuntu-latest
    name: print Run ID
    steps:
      - name: Print the current run id
        run: echo "PR_NUMBER" $RUN_ID
      - name: custom actions
        id: custom-action
        uses: KK-Repos/NotifyJobStatus@v1.2
        with:
          ORG: $ORG
          REPO: $ORG
          RUN_ID: ${{ github.run_id }}
          CHANNEL_ID: $CHANNEL_ID
          SLACK_BOT_TOKEN: $SLACK_BOT_TOKEN
      - name: Use Custom Action Output
        run: echo ${{ steps.custom-action.outputs.my_output }}
